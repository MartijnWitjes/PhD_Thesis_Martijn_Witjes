\chapter[Introduction]{Introduction}
\label{cha:Chapter1}
\vspace*{\fill}


\newpage

\section{Background}

\subsection{Land cover}

    Land cover---the physical and biological material found on the surface of the earth---encompasses natural environments like forests, grasslands, wetlands, and things made by humans, like urban areas, croplands, and infrastructure \citep{fisher2005land}. 
    
    Its study and monitoring are crucial for a multitude of reasons. Land cover changes significantly influence regional and global climate patterns and are a major driver of biodiversity loss, emphasizing the necessity of monitoring for climate change mitigation and biodiversity preservation \citep{pielke2002influence, houghton2012carbon, sala2000global, cbd2016indicators}. 
    
    Additionally, these changes have direct implications for the quality and availability of natural resources, such as water and air \citep{foley2005global}. Land cover assessment is vital for evaluating the livability of human environments \citep{krekel2016greener,levering2024landscape} and has key applications in informing policy, analyzing land-based emissions, and estimating local climate extremes \citep{duveiller2020, hong2021luemissions, sy2020,}. 

    Therefore, understanding land cover dynamics is crucial for effective policy-making at both regional and global levels \citep{liu2020assessing, trisurat2019land, shumba2020effectiveness}. As different entities with different objectives require maps with different characteristics and aspects, the choice of which type of land cover to map is a central one. 

\subsection{General land cover classes}

    \subsubsection{Crops and Grasslands}

        Croplands and grasslands are essential for food production, and together cover over 40\% of the European Union's territory \citep{eurostat2021land}. European cropland is a diverse land cover type; over 100 crops are produced at scale in Europe, ranging from cereals such as wheat and rice to sunflowers, tobacco, and herbs such as basil and valerian \citep{eurostat2023agricultural}. Grasslands, on the other hand, cover wide roles beyond dairy and meat production: water supply and flow regulation, carbon storage, erosion control, climate mitigation, pollination, and cultural significance \citep{bengtsson2019grasslands}. 
        
        The agricultural sector is not only a cornerstone of the EU's economy, but also a significant employer, with approximately 4.2\% of the EU's population engaged in agriculture. Reflecting its importance, the European Union's Common Agricultural Policy (CAP) has earmarked {\texteuro}264 billion as agricultural subsidy for the 2023--2027 period. The economic magnitude of crop and livestock production makes tracking and understanding their dynamics in the EU a priority for many stakeholders.

    \subsubsection{Forests}

        Forests cover nearly a third of the planet's land area \citep{fao2022,banskota2014forest} and more than 41\% of the EU \citep{eurostat2021land}. They are important for biodiversity \citep{cazzolla2022number}, carbon sequestration \citep{ipcc2021}, and have been supplying a plethora of resources used by human civilization since the palaeolithic. Given recent trends of globalization and deforestation, monitoring forest cover change and its drivers is crucial \citep{sy2019tropical,masolele2024mapping} for a great number of actors, including the UN and national governments, the industrial sector, local communities, and Indigenous peoples. National forest inventories, statisticians, and mapping organizations often disagree about the quantity of forest in any given area, which can lead to fierce scientific debates \citep{picard2021recent, korhonen2020new, palahi2021concerns, rossi2019assessing}
    
    \subsubsection{Wetlands}

        Wetlands, recognized as one of the most biologically productive and important natural ecosystems, play a pivotal role in regulating the global climate, maintaining the hydrological cycle, and supporting diverse species \citep{hu2017global,ramsar2001wetlands}. The unique hydrology of these ecosystems influences the distribution of sediment, nutrients, flora, and fauna. They provide essential services such as improving water quality, flood mitigation, recharging aquifers, and supporting an array of wildlife \citep{costanza1997value,smardon2009sustaining}. Despite these benefits, wetlands have historically been undervalued, often seen as wastelands or disease sources, leading to significant losses due to reclamation and degradation \citep{giblett1996postmodern,owens2001global,davidson2014much,gardner2018global,dugan1993wetlands,oecd1996guidelines,ramsar2015wetlands}. The world has witnessed a dramatic decline in wetland areas, with an estimated 87\% degradation since 1700, particularly in the 20th and early 21st centuries, resulting in substantial economic losses and reduced ecosystem service value \citep{gardner2015state,costanza2014changes}. While they only cover 1.7\% of the EU \citep{eurostat2021land}, their vital role and the alarming rate of loss make it crucial to preserve their ecological integrity and ensure the continued provision of their invaluable ecosystem services.

    \subsubsection{Land Use}

        There is another way besides land \textit{cover} to describe land: With land \textit{use}. Land Use does not refer to what's there, but how it is being used by humans. A grassland can be an intensively grazed pasture or a protected nature reserve. A 'forest' can be a palm oil plantation, a recreational area, or a rare old-growth forest with religious significance. The term 'Land Use' is sometimes used interchangeably with Land Cover \citep{fisher2005land}, and different authors make different distinctions. For example, \citet{hansen2022global} group inland water and wetlands as land cover, and built-up area, cropland and tree cover change as land use. Sometimes, a legend contains classes that are combinations of Land Use / Land Cover (LULC), such as pastures and natural grasslands in CORINE land cover, or even the grass fields at airports in the LUISA Basemap of Europe \citep{pigaiani2021luisa}. Because such classes can be ambiguous and hard to map by computer programs, they are not often reproduced at scale with remote sensing techniques. The LUCAS survey makes a clear distinction between land use and land cover: each observation has a separate listing for both types, with some combinations occurring frequently (like \textit{agricultural} use and \textit{grassland} cover to represent \textit{pastures}), and others being extremely rare (\textit{residential} use and \textit{peat bog} cover).

    \subsubsection{What should be on a map?}

        Broad categories such as 'Forest' or 'Water' are relatively simple for people and computers to differentiate. However, adding more detail to the map by splitting up these big categories into more specific classes, or improving the \textit{thematic resolution}, brings many challenges. First of all, maps with many classes are hard to read by humans. Reading a complex map is not always necessary, as users can derive simpler maps from rich datasets to tailor them to their use case \citep{tsendbazar2017integrating} or use the mapped values for a different type of analysis. 
        Secondly, the process of making detailed maps is more costly and difficult. You need to collect more examples from more different categories, and not all categories are equally easy to distinguish by surveyors. Someone interpreting aerial imagery might be able to distinguish grassland from forest, but what if they want to map different tree species, or distinguish pastures from natural grassland?
        Which brings us to the next question: How do you get those maps in spite of those challenges? People used to draw maps based on field surveys. Later maps were based on aerial imagery. In recent decades, we have been increasingly using remote sensing and machine learning.

    \subsubsection{Land cover and land use mapping and monitoring in EU}

        Especially in Europe, long-running datasets, such as the Coordination of Information on the Environment (CORINE) Land Cover Project and the Land Use / Cover Area frame Survey (LUCAS) \citep{dandrimont2021lucas}, have provided detailed and consistent land cover information for almost two decades \citep{gallego2008using}. 
        CORINE is a good example of a detailed land cover dataset experiencing th . CORINE is an initiative by the European Environment Agency (EEA) that aims to collect information on the land cover of Europe to support environmental policy development. The project started in 1985 as part of the European Commission's CORINE program, designed to gather and harmonize data related to the environment across the member states. In the subsequent decades, it was used to assess land cover changes in Europe \citep{mucher2000land, feranec2010determining}. 

        However, as the project evolved and standards for environmental data became more stringent, its limitations became increasingly apparent. 
        The nature of its legend, which often combines land use and land cover within the same category, and the presence of mixed classes such as \textit{airport} (grass, buildings, roads).
        Furthermore, the project's reliance on a 25 hectare minimum mapping unit for most LULC types means that it only contains relatively large patches (see Fig.\@~\ref{fig:biesbosch_osm_clc}). This means it under-represents LULC types and is of limited accuracy at fine spatial scales \citep{buttner2014corine,aune2021content, pflugmacher2019mapping}. Regardless, CORINE Land Cover is among the most popular and widely used European land cover datasets, and should not be discarded. As using human cartographers at a finer spatial and temporal scale would be prohibitively difficult, slow, and costly, attempts have been made to automate the production of CLC \citep{buttner2014corine}, but usually at a lower thematic resolution, for example for 12 \citep{pflugmacher2019mapping} or 14 \citep{bhugra2022rapidai4eo} classes. There have also been other projects that accurately map European land cover at high spatial resolution using different legends that are more optimized for a remote sensing context, such as S2GLC \citep{malinowski2020}, and attempts to specifically map crop types with specialized approaches \citep{dandrimont2021parcel,luo2022developing}

        \begin{figure}[H]
            \centering
            % Left column
            \begin{minipage}{0.5\textwidth}
                \centering
                \includegraphics[width=\linewidth]{figs_01/biesbosch_osm.png}
                \caption{The Biesbosch wetlands area in the Netherlands, as represented on OpenStreetMap.}
                \label{fig:first_col_first_fig}
                \vspace{1em} % Space between the figures in the first column
                \includegraphics[width=\linewidth]{figs_01/biesbosch_clc.png}
                \caption{The Biesbosch as represented by CORINE Land Cover.}
            \end{minipage}
            \hfill
            % Right column
            \begin{minipage}{0.49\textwidth}
                \centering
                \includegraphics[width=\linewidth,height=2.15\textwidth,keepaspectratio]{figs_01/corine_legend.pdf}
                \caption{The 43-class CORINE Land Cover legend.}
                \label{fig:biesbosch_osm_clc}
            \end{minipage}
            \label{fig:two_column_layout}
        \end{figure}

\subsection{Land cover classification with machine learning and earth observation data}
    
    Automated mapping methods, such as those used by \citet{pflugmacher2019mapping}, \citet{dandrimont2021parcel}, \citet{luo2022developing} and \citet{malinowski2020automated} are called Land Cover Classification. It typically involves showing many good examples of the things you want to detect on a map to a computer program, which then learns how to recognize them by itself when shown new locations. For this, the following three core components are needed:
    
    \begin{itemize}
    \item \textbf{Examples:} Confirmed and annotated observations of different types of land cover, with a known time and place. We often call these observations \textbf{reference data}, \textit{labels}, or \textit{samples}.
    \item \textbf{Earth observation (EO) data:} satellite imagery and other geographic data that cover the area you want to map. Together, these \textbf{covariates} form the \textbf{feature space}. Spatial and temporal metadata allow aspiring mappers to combine several existing, unrelated datasets into one feature space; a rarity in the machine learning domain.
    \item A \textbf{model:} Some kind of decision-making algorithm that learns to recognize which examples often occur at which combination of the covariates. If this goes well, you can use it to \textbf{predict}, or \textit{classify}, which land cover occurs at locations that are covered by the feature space, but where reference data are not available.
    \end{itemize}
    
    It is common to use different sets of reference data: one set to train your model, and one independent set to validate its predictions, namely the land cover maps it has made. It is good if these two datasets were collected separately from each other, because this helps to make sure your model \textbf{generalizes} well: that its predictions are accurate in new situations, not just on the data it was trained on.

    \subsubsection{Training data}

        Training data is a set of labeled observations that are used to teach a machine learning model to recognize similar things in new situations. To make sure your model generalizes well, you have to properly represent the feature space of the area you want to map in your training data \citep{meyer2021predicting}. This does not directly relate to geographical space; large homogeneous areas such as deserts tend to be quite similar in the feature space, while small complex landscapes such as cities with parks, gardens and canals will show great local variation. 

        It is important to have enough training examples \citep{ramezan2021effects,rodriguez-perez2017influence,zhu2016optimizing}, but what is `enough' differs per model \citep{myburgh2014impact} and task \citep{koshute2021recommending}. 
        Models often learn to estimate classes in the same proportions as their training data. If these proportions do not match the real-world situation of the area they need to map, the model may become \textbf{biased}. To minimize this bias and predict the right relative quantities for each class, you need training data that match the desired proportions \citep{he2009learning}.
        
    \subsubsection{Validation data}

        All maps are wrong \citep{monmonier2018how}, and maps produced with machine learning and earth observation data are no exception. Errors can be defined as \textit{quantity disagreement} and \textit{allocation disagreement}: are there enough pixels of every class, and are they in the right place \citep{pontius2006can,pontius2011death}? Ideally, both types of errors should be low. Errors can come from various sources. Some classes might be hard to distinguish in the available feature space, confusing the model \citep{shivakumar2017spectral}. Some classes might be overrepresented in the training data, leading the model to predict it more frequently at the expense of other classes and resulting in low quantity agreement.

        In general, it is essential that any map is validated with a set of observations. Such validation datasets need to be of high quality: their accuracy should surpass the target accuracy of the map and they need to be representative of the classes in the mapped area.
    
        Biased training data can lead to a biased model that overpredicts certain classes. In this case, the proportions of the classes on the map will deviate from the proportions in the real world. It is very difficult to quantify the bias of a model before it is used \citep{stehman2013estimating}, and the current best way of fixing the proportions on a map is to measure the model bias with additional sampling after the mapping is complete \citep{stehman2014estimating}.

        Classification errors become even more troublesome when land cover change is measured by comparing maps from two time periods, as any misclassified pixel will be interpreted as a change \citep{olofsson2013making}. This can be counteracted by careful sampling design \citep{stehman2012impact,olofsson2014good}, although some work has been done to circumvent this and derive area estimates directly from the model predictions \citep{sales2022land,kleinewillinghofer2022unbiased,angelopoulos2023predictionpowered}.
        All in all, it is important to validate annual large-scale maps with up-to date validation data to ensure there is no dataset drift and to properly quantify accuracy and uncertainty \citep{tsendbazar2021towards}.

    \subsubsection{Earth Observation Data}

        Earth observation data refers to measurements taken by sensors at various ranges, from ground measurements \citep{shahi2015novel} to drone \citep{tang2015drone} and airplane \citep{mastelic2020aerial} imagery, to satellite scans \citep{phiri2020sentinel}. The most useful for recurring large-scale mapping are satellite scans, as satellites revisit the same area at a regular pace. This allows them to provide a consistent stream of data, which, in some cases, can continue for decades \citep{xiong2020modis,wulder2022fifty}. The activity of remotely collecting Earth observation data is generally referred to as \textbf{remote sensing}.

        Earth observation data only started becoming openly available after Brazil published its LANDSAT archives as open data in 2008 \citep{nature2008markets}. Afterwards, more and more Earth observation data and land cover information has become openly available. While this rapidly growing landscape of increasingly large datasets on diverging platforms and systems can be hard to navigate \citep{wagemann2021a}, it has fuelled an exponential increase in the amount of mapping initiatives and environmental awareness \citep{wulder2022fifty}, with applications ranging from deforestation \citep{hansen2013high} to soil mapping \citep{hengl2017soilgrids250m}. For further reading on the role of remote sensing in quantifying essential characteristics of the biosphere, cryosphere, and hydrosphere, readers are directed to \citet{radeloff2024need}, which provides an up-to-date review of the state of the art and current needs.
        
        Spatial machine learning is unique in the sense that it allows modelers to easily combine variables if they can somehow acquire a representation of them at the time and place of the ground truth observation, such as with a spatial or spatiotemporal overlay. Combining different data sources can lead to much higher performance, for instance with crop stress detection  \citep{berger2022multi}, urban heat \citep{shahi2015novel}, and land cover classification \citep{zhu2016optimizing, hurskainen2019auxiliary, hosseiny2022urban,xu20183d}. Having data of the same place from different moments \citep{low2013impact} and different spatial resolutions or scales \citep{santos2012multiscale} can also improve mapping accuracy, especially of classes that have very similar spectral profiles and/or cyclical temporal dynamics, such as crops and grassland \citep{esch2014differentiation}.

\subsection*{The current land cover mapping arms race}

   In the past decades, machine learning has been used to make land use and land cover maps at global scales. Due to limitations in the resolution of the available satellite data, such maps were at resolutions of 5~km for GLASS-GLC \citep{liu2020annual}, 300~m for ESA CCI \citep{defourny2012land} or 100~m for Copernicus Global Land Cover \citep{buchhorn2020copernicus}. This made them useful for large scale analysis, but of limited value for local applications and analyses, such as investigating small-scale land use as drivers of deforestation \citep{masolele2024mapping}. However, in the last few years, the increased availability and analysis-readiness of high-resolution from NASA's Landsat and ESA's Sentinel-2 programmes have enabled the creation of global- and continental-scale high-resolution land cover maps by several organizations. Notable examples are ESA's WorldCover \citep{kerchove2021esa} and WorldCereal \citep{tricht2023worldcereal}, Google's DynamicWorld \citep{brown2022dynamic}, ESRI's Land Cover \citep{karra2021global}, and GLAD's Global Land Cover \citep{potapov2022global}.
    These maps often have high resolution and high accuracy, but are usually limited in multiple ways: reproducibility, time coverage, and detail:
    
    \subsubsection{Reproducibility}
        Most of the current big mapping initiatives only share their maps, not the reference data that they used to produce them. This not only makes it difficult or impossible to reproduce, challenge, or improve their work, but also prevents it from being used for new projects \citep{tsendbazar2015assessing}. If they don't share their validation data, independent validations are dependent on open validation datasets \citep{venter2022global}, which might not perfectly match their legend, making a fair comparison more difficult.
    
    \subsubsection{Time coverage} 
        Most of the current generation of maps use 10~m Sentinel-2 data, which only became available in 2016. Mapping initiatives that use Landsat data can go back much further, but are then limited to mapping at 30m resolution. Examples are the Australian land cover time series made by \citep{calderon2021high} and the work of UMD GLAD, which produced annual land cover maps from the year 2000 onwards using Landsat data \citep{hansen2022global}. \citet{garcia2022global} provides an thorough overview of LULC datasets with long-running time series.

    \subsubsection{Detail}
        %Visual interpretation mention specifically!
        Often, these maps depict at most ten land cover categories (see Table~\ref{tab:bigmaps}). Mapping more classes is more difficult because there is more chance of confusion between similar classes. This also applies to the creation of training data: The current most common way to create it is by visual inspection of high resolution aerial or satellite imagery, and this becomes more difficult with more specific classes. Just like for a machine learning model, it is much easier for an annotator to differentiate between a forest and cropland than between different cereal crop types. Classifying more different classes is also more difficult for machine learning models and requires more training data, and of higher quality, which is an expensive and complex task \citep{li2021improving}, especially for large diverse areas (e.g., continents or the whole planet) \citep{tsendbazar2021towards,stanimirova2023global}. 

\begin{figure}[H]
    \centering
    \begin{subfigure}[t]{0.243\textwidth}
        \centering
        \includegraphics[width=\textwidth,height=\textwidth]{figs_01/a_dynamicworld_clean.png}
    \end{subfigure}
    \hfill % Distribute subfigures evenly in the line
    \begin{subfigure}[t]{0.243\textwidth}
        \centering
        \includegraphics[width=\textwidth,height=\textwidth]{figs_01/a_esri_clean.png}
    \end{subfigure}
    \hfill % Distribute subfigures evenly in the line
    \begin{subfigure}[t]{0.243\textwidth}
        \centering
        \includegraphics[width=\textwidth,height=\textwidth]{figs_01/a_worldcover_clean.png}
    \end{subfigure}
    \hfill % Distribute subfigures evenly in the line
    \begin{subfigure}[t]{0.243\textwidth}
        \centering
        \includegraphics[width=\textwidth,height=\textwidth]{figs_01/a_glad_clean.png}
    \end{subfigure}
    % No \hfill here as we want to force the next subfigure to the next line
    % \vspace{0.1em} % Adds a bit of vertical space between the rows of figures, adjust as needed
    
    \begin{subfigure}[b]{\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figs_01/thesis_legends-harmonized.pdf}
    \end{subfigure}
    
    \caption{Comparison of four global mapping projects in the Biesbosch wetlands area in the Netherlands: Google Dynamic World \citep{brown2022dynamic}, ESRI Land Cover \citep{karra2021global}, ESA WorldCover \citep{zanaga2022esa}, and GLAD Land Cover \citep{potapov2022global}. Note that each legend is more specific in some thematic types: GLAD differentiates more strongly based on tree cover, while ESA WorldCover differentiates more between different types of non-forested dry land.}
    \label{fig:bigmaps_biesbosch}
\end{figure}


 
    Although there are exceptions to each of these issues, in general, all of the current mapping initiatives have at least one of these limitations (see Table\@~\ref{tab:bigmaps}). There is value in mapping as far back as possible, something that the previous generation of global maps did do \citep{garcia2022global}. An extreme example is the History database of the Global Environment (HYDE), which contains historic estimated maps at 10~km resolution of main land use categories going back more than 10 thousand years. (Klein Goldewijk et al. 2017). HYDE is also quite detailed, and includes irrigated areas, rice, intensive pasture, extensive rangelands and similar classes. This makes it useful despite its low spatial resolution. Regardless, there is a need for modern maps that do not sacrifice detail to maintain useful spatial resolution and accuracy, and which are made transparently and reproducibly, so that they can be challenged, improved, and trusted.

    \begin{table}[h]
    \centering
    % \resizebox{\textwidth}{!}{%
    % \begin{tabularx}{\textwidth}{|X|X|X|X|X|X|X|}
    \begin{tabularx}{\textwidth}{>{\hsize=1.5\hsize}X|>{\hsize=.7\hsize}X|>{\hsize=.9\hsize}X|>{\hsize=.9\hsize}X|>{\hsize=.7\hsize}X|>{\hsize=.9\hsize}X>{\hsize=.9\hsize}X}
    \toprule
    \textbf{Mapping \makecell{Product}}                                                & \textbf{Classes}  & \textbf{Training Data}                & \textbf{Validation Data}              & \textbf{Spatial Res.} & \textbf{Time Res.}  \\ \hline
    ESA WorldCover \citep{zanaga2022esa}                                    & 11                & No                                    & No                                    & 10~m                      & 2020, 2021            \\ \hline
    ESA WorldCereal \citep{tricht2023worldcereal}                           & 10                & Yes \citep{worldcereal_rdm}           & Yes \citep{lesiv2023global}           & 10~m                      & 2021                  \\ \hline
    Google DynamicWorld \citep{brown2022dynamic}                            & 9                 & Yes \citep{tait2021dwtd}              & No                                    & 10~m                      & 2016+, monthly        \\ \hline 
    ESRI Land Cover \citep{karra2021global}                                 & 9                 & No                                    & No                                    & 10~m                      & 2017--2021, annual    \\ \hline
    \makecell[l]{GLAD Global} \makecell[l]{Land Cover and} \makecell[l]{Land Use} \makecell[l]{Change \citep{potapov2022global}}    & 7                 & No                                    & No                                    & 30~m                      & 2000--2020, annual    \\ \hline 
    GLC\_FC30 \citep{zhang2020glcfcs30}                                     & 30                & No                                    & Yes \citep{liangyun2019dataset}       & 30~m                      & 1982--2021, annual*   \\ \hline
    S2GLC Maps of Europe \citep{malinowski2020automated}                    & 13                & No                                    & Yes \citep{jenerowicz2021validation}  & 10~m                      & 2017                  \\ \hline 
    ELC10 \citep{venter2021continentalscale}                                & 8                 & Yes \citep{dandrimont2020harmonised}  & Yes (cross-validation)                & 10~m                      & 2020                  \\ \hline
    Pan-European land cover \citep{pflugmacher2019mapping}                  & 12                & Yes \citep{dandrimont2020harmonised}  & Yes (cross-validation)                & 30~m                      & One year              \\ \hline 
    Australian Land Cover \citep{calderon2021high}                          & 6                 & No                                    & No                                    & 30~m                      & 1985-2015             \\ \bottomrule
    \end{tabularx}
    % }%
    \caption{Summary of Mapping Products and Data Availability}
    \label{tab:bigmaps}
    \end{table}

    
% Several initiatives aim at integrating multiple land cover products \citep{herold2016toward}(Herold et al. 2016) and/or running land cover classification by fusing multisource EO data \citep{song2017improving,liu2021finer}.
% 
% However, the fact that there is now significant interest in getting the most current, most accurate, and most detailed (spatial resolution) products showing the dynamics of land cover and land use is excellent news! Fair competition should be embraced or as the famous Chinese poem says \emph{``Let a hundred flowers bloom; let a hundred schools of thought contend.''}

\section{Research Gaps}

    There is a reproducibility crisis in science, and environmental monitoring is no exception \citep{treves2022best, powers2018open}. How can decision-makers trust datasets whose creation does not only involve complex workflows, but can not be reproduced or improved? It turns out that they often don't, and keep relying on older methods that might be slow and expensive, but reproducible and reliable. The current boom in for-profit remote sensing has allowed for excellent analysis using high-resolution data ---e.g., drivers of deforestation in Africa \citep{masolele2024mapping} using 3~m resolution Planet data--- but limitations on sharing this data, and the profit and marketing motivations of corporations make sharing, trusting, and using their maps difficult.

    There are no reproducible large-scale maps with more than 13 classes, not even for Europe, for which an unprecedented wealth of land cover information is publicly available \citep{dandrimont2020harmonised}. \citet{pflugmacher2019mapping} demonstrated that the LUCAS points can be used to train and validate land cover models, but the LUCAS legend is a hierarchical system with over 70 land cover and land use classes. To retain its use as a validation set, training data should be extracted from other human-annotated datasets such as CORINE, EuroCrops \citep{schneider2023eurocrops} and OpenStreetMap \citep{schultz2017open}.  In order to use data with the large minimal mapping unit of CORINE or the potential errors in volunteered geographical information \citep{neis2014recent}, filtering techniques are required to remove spurious training samples.

    Furthermore, while some long-term annual mapping projects exist, they either have a low spatial resolution like ESA CCI \citep{harper202229}, cover only a select set of classes \citep{potapov2022global}, or did not publish their training data \citep{zhang2020glcfcs30}. 

    Lastly, to evaluate the impacts of human activities on the environment and to both enable and justify localized interventions, it is essential that trends from area estimates and periodic maps are linked \citep{olofsson2014good,szantoi2020addressing,winkler2021global}. This requires a mapping framework that minimizes both quantity and allocation error \citep{pontius2011death}. While many mapping initiatives report class proportions \citep{pflugmacher2019mapping} or try to approximate correct area estimation with direct remote sensing measures \citep{kleinewillinghofer2022unbiased}, only a few explicitly investigate methods to force maps to match area estimates \citep{strahler1980use,horvath2021comparison}.
    

\section{Objectives}
\label{sec:research_objectives}
The overall objective of this PhD thesis is to take advantage of the availability of various open European land use / land cover datasets and statistics, and to combine these with Earth observation data and machine learning to make accurate, detailed maps that are compatible with the needs of European policy makers and researchers. More specifically, this thesis aims to answer the following research questions:

\begin{enumerate}
\item %The Value of Aggregating and Combining Time-Series and Static EO Data for Land Cover Classification: 
What are the benefits and challenges of combining multiple large time-series and static EO datasets into analysis-ready data for the purpose of land cover classification?
\item % The Value of a Spatiotemporal Approach for Land Cover Classification: 
To what extent does training data from multiple times and places improve the accuracy and generalization of land cover classification?
\item % The Effect of Legend Design and Size: 
How does the number and type of classes in a legend affect the accuracy of land cover classification?
\item % Ensuring Land Cover Maps Match Area Estimates Without Sacrificing Accuracy: 
What is the effect of enforcing design-based class proportions on map accuracy?
\end{enumerate}

\section{Thesis Outline}

The research questions posed in the previous section are answered through four research papers, which are presented as chapters in this thesis. Fig.\@~\ref{fig:01_rqs_chapters} provides a graphical overview of how each chapter relates to each research question framework. The first two chapters focus on combining earth observation and land cover data from multiple sources to train models that can generalize well to unknown years. Chapter\@~\ref{cha:chapter4} applies a novel algorithm that uses a-priori class proportions from area estimates to optimize the accuracy and quantity of predictions by such models.

\begin{figure}[H]
    \centering
    \includegraphics[width=.55\textwidth]{figs_01/fig_rqs_chapters.pdf}
    \caption{Overview of which chapters discuss which research questions.}
    \label{fig:01_rqs_chapters}
\end{figure}

\textbf{Chapter 2} focuses on the benefits and challenges of harmonizing and combining large-scale spatiotemporal datasets for land cover mapping, most of which were used in the following chapters. The chapter details the work that went into creating, harmonizing, and imputing multiple Earth observation datasets (Landsat, Sentinel-2, and a new 30m resolution DTM) covering Europe. It introduces and describes the imputation algorithm TMWM that was used to impute the Landsat data, and validates its accuracy in a spatiotemporally explicit way. It then explores how combining the different datasets improves the accuracy of land cover classification models. Lastly, it shows that models trained on samples from a longer time range can generalize better to years that they have not been trained on.

\textbf{Chapter 3} focuses on the production of annual land use / land cover maps of Europe for 2000-2020. It details the steps taken to harmonize and clean the training data from multiple openly available sources (CORINE, LUCAS) into a legend with 43 classes. A thorough accuracy assessment using cross-validation and an independent set of S2GLC validation points describes how well the model generalizes across space and time, and quantifies the trade-off imposed by having a legend with high thematic resolution. Results show that the maps have similar accuracy as other current continental-scale maps at low thematic resolution, and that a more detailed legend introduces more errors.

\textbf{Chapter 4} introduces IMP, an algorithm that uses land cover area estimates to iteratively classify land cover from existing probabilities, producing maps whose class proportions match the input estimates. It details the algorithm and showcases its use by mapping five European countries in five years. The accuracy of the maps is compared with maps created using highest likelihood classification. Results show that the proportional maps do not only have more accurate class proportions, but equal or better accuracy than highest likelihood maps. We also compare the accuracy and proportions of maps based on probabilities predicted by models trained on data representative of the area of interest, and probabilities predicted by a general model trained on large parts of Europe. Results show that maps based on general model predictions reach more accurate class proportions, while maps based on local model predictions are slightly more accurate. Finally, it presents an unintentional finding that the iterations at which the algorithm classifies certain pixels is related to the accuracy of those pixels, suggesting that it can be used to generate pixel-level accuracy estimates.